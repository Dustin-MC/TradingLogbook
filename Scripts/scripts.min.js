{var currentSection=0,hideMenu=!0;function RoundNumber(e,t=2){return Number(e.toFixed(t))}chartsRef=[],orderHistory=null,oldestBalance=null,document.addEventListener("DOMContentLoaded",()=>{let e=localStorage.getItem("theme");0==e?ChangeThemeMode(0,!1):1==e?ChangeThemeMode(1,!1):localStorage.setItem("theme",2)}),window.onload=function(){if(null!=localStorage.getItem("themeColors")){let e=localStorage.getItem("themeColors").split(","),t=document.querySelectorAll(".customColor");for(let o=0;o<t.length;o++)t[o].value=e[o]}null!=localStorage.getItem("orderH")&&(orderHistory=[],JSON.parse(localStorage.getItem("orderH")).forEach(e=>{orderHistory.push(e)}),GenerateChartsData())}}{function HideMenu(e){e?document.querySelector(".nav__body").classList.add("display--n"):document.querySelector(".nav__body").classList.remove("display--n")}document.querySelector(".navToggler").onclick=function(){document.querySelector(".nav__body").classList.toggle("display--n")}}{let e=document.querySelectorAll(".section"),t=document.querySelectorAll(".nav__item"),o=document.querySelectorAll(".btn--section");function ToggleSection(t){let o=document.querySelector(".lang"),r=document.querySelector(".newOpContainer").classList;r.contains("display--n")||r.toggle("display--n"),currentSection!=t?(e[t].classList.toggle("display--n"),e[currentSection].classList.toggle("display--n"),currentSection=t,hideMenu&&HideMenu(!0),o.hasAttribute("open")&&o.removeAttribute("open")):alert("Current section!")}for(let e=0;e<t.length;e++)if(e<4)t[e].onclick=function(){ToggleSection(e)};else{if(4==e)continue;t[e].onclick=function(){ToggleSection(e-1)}}for(let e=0;e<o.length;e++)o[e].onclick=function(){ToggleSection(e+1)}}{let e=document.querySelector(":root"),t=document.querySelectorAll(".customColor"),o=getComputedStyle(e),r=document.querySelectorAll(".btn--theme");function TemporalThemeMode(){r.forEach(e=>{e.disabled=!0});let o=[getComputedStyle(e).getPropertyValue("--mainColor"),getComputedStyle(e).getPropertyValue("--secondColor"),getComputedStyle(e).getPropertyValue("--color1"),getComputedStyle(e).getPropertyValue("--color2")];e.style.setProperty("--mainColor",t[0].value),e.style.setProperty("--secondColor",t[1].value),e.style.setProperty("--color1",t[2].value),e.style.setProperty("--color2",t[3].value),setTimeout(function(){e.style.setProperty("--mainColor",o[0]),e.style.setProperty("--secondColor",o[1]),e.style.setProperty("--color1",o[2]),e.style.setProperty("--color2",o[3]),r.forEach(e=>{e.removeAttribute("disabled")})},4e3)}function ChangeThemeMode(r,l=!0,a=!1){if(localStorage.setItem("theme",r),0==r)if(l)document.querySelector(".customThemeContainer").classList.toggle("display--n"),e.style.setProperty("--mainColor",t[0].value),e.style.setProperty("--secondColor",t[1].value),e.style.setProperty("--color1",t[2].value),e.style.setProperty("--color2",t[3].value),localStorage.setItem("themeColors",[t[0].value,t[1].value,t[2].value,t[3].value]),null!=orderHistory&&GenerateCharts();else{let o=localStorage.getItem("themeColors").split(",");if(a)for(let e=0;e<t.length;e++)t[e].value=o[e];e.style.setProperty("--mainColor",o[0]),e.style.setProperty("--secondColor",o[1]),e.style.setProperty("--color1",o[2]),e.style.setProperty("--color2",o[3])}else 1==r?(e.style.setProperty("--mainColor",o.getPropertyValue("--themeColor2")),e.style.setProperty("--secondColor",o.getPropertyValue("--themeColor1"))):(e.style.setProperty("--mainColor",o.getPropertyValue("--themeColor1")),e.style.setProperty("--secondColor",o.getPropertyValue("--themeColor2"))),e.style.setProperty("--color1",o.getPropertyValue("--themeColor3")),e.style.setProperty("--color2",o.getPropertyValue("--themeColor4")),l&&null!=orderHistory&&GenerateCharts()}r.forEach(e=>{"temp"==e.dataset.mode?e.onclick=(()=>TemporalThemeMode()):"custom"==e.dataset.mode?e.onclick=(()=>document.querySelector(".customThemeContainer").classList.toggle("display--n")):e.onclick=(()=>{ChangeThemeMode(parseInt(e.dataset.mode)),document.querySelector(".customThemeContainer").classList.add("display--n")})})}{let e=document.querySelector(".excelInput"),t=document.querySelector(".dataFormat");function SaveOperationData(){let e=[],t=[],o=!0,r=document.querySelectorAll(".newOp__item"),l=document.querySelector(".newOp__item--pnl");r.forEach((t,a)=>{if(""!=t.value)if(6!=a)7!=a&&(5==a?"%"==l.value?e[a]=RoundNumber(Number(t.value)/100):"$"==l.value?e[a]=RoundNumber(Number(t.value)/(e[2]*e[3]),4):(e[a]=RoundNumber(Number(t.value)),o=!1):"number"==t.dataset.type?e[a]=RoundNumber(Number(t.value)):e[a]=t.value);else try{let l,n=`${t.value} ${r[a+1].value}:00Z`;l=new Date(n),l=new Date(Date.UTC(l.getFullYear(),l.getMonth(),l.getDate(),l.getHours()+l.getTimezoneOffset()/60,l.getMinutes(),0)),l=l.toJSON().replace("T"," ").replace(".000Z",""),e[a]=l}catch{o=!1}else o=!1}),!e.includes(null)&&e[3]>0||(o=!1),t=[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[8]],"true"==t[4]?t[4]=!0:"false"==t[4]?t[4]=!1:t[4],o?(AddNewOperations([JSON.stringify(t)]),localStorage.removeItem("tempOp"),ClearOpInputs(),document.querySelector(".newOpContainer").classList.toggle("display--n")):(localStorage.setItem("tempOp",JSON.stringify(t)),alert("Data saved!\n\tFill in the missing data to graph the operation"))}async function ImportData(){let o=[];try{if("bingx"==t.value){let t=await readXlsxFile(e.files[0]);for(let e=2;e<t.length;e++){let r=[t[e][2],t[e][3],t[e][5],t[e][4],t[e][8],t[e][16],ConvertDate(t[e][13]),t[e][14]];"long"==r[4]?r[4]=!0:r[4]=!1,r[5]=RoundNumber(r[5]/(r[2]*r[3])),o.push(JSON.stringify(r))}AddNewOperations(o)}else if("tohsg"==t.value){let t=e.files[0],r=new FileReader;r.readAsText(t),r.onload=function(){try{t.name.includes("theme")?(localStorage.setItem("themeColors",r.result),ChangeThemeMode(0,!1,!0),null!=orderHistory&&GenerateCharts()):(JSON.parse(r.result).forEach(e=>{o.push(JSON.stringify(e))}),AddNewOperations(o))}catch(e){console.log("TOHSG error\n",e),alert("Action not completed! \n\tTry again or Select another file.")}}}}catch(e){console.log("BingX error\n",e),alert("Action not completed! \n\tTry again or Select another file.")}}function AddNewOperations(e){let t=[];null==orderHistory&&(orderHistory=[]),orderHistory.forEach(e=>{t.push(JSON.stringify(e))}),e.forEach(e=>{t.includes(e)||(t.push(e),orderHistory.push(JSON.parse(e)))}),localStorage.setItem("orderH",JSON.stringify(orderHistory)),GenerateChartsData(),alert("Action success!\n\tOperation/s added without errors")}function ConvertDate(e,t=!0){let o;if(e=e.toJSON(),t){let t=e.slice(0,4),r=Number(e.slice(5,7)),l=e.slice(8,10),a=e.slice(11,13),n=e.slice(14,16),s=e.slice(17,19);utcDiference=8,o=new Date(Date.UTC(t,r-1,l,a-utcDiference,n,s)).toJSON()}else o=new Date(e).toJSON();return o=o.slice(0,-5).replace("T"," "),o}function ExportData(){let e,t,o,r=!1;if("theme"==$dataExport.value?0==localStorage.getItem("theme")?(r=!0,t="themeMode",e=localStorage.getItem("themeColors")):alert("Action not completed!\n\tThere is currently no custom theme selected."):"tohsg"==$dataExport.value&&(null!=orderHistory?(t="data",r=!0,e=JSON.stringify(orderHistory)):alert("Action not completed!\n\tThere is currently no existing data to export.")),r){o=new Date,o=`${o.getFullYear()}.${o.getMonth()+1}.${o.getDate()}`;let r=document.createElement("a"),l=new Blob([e],{type:"octect/stream"}),a=window.URL.createObjectURL(l);r.href=a,r.download=`TOHSG_${t}_${o}.txt`,r.click(),window.URL.revokeObjectURL(a)}}function ClearOpInputs(){let e=document.querySelectorAll(".newOp__item");e.forEach(e=>{e.disabled||(e.value="")}),document.querySelector(".newOp__item--pnl").value=""}function SetOpInputsData(e){let t=document.querySelectorAll(".newOp__item");e=JSON.parse(e),e.forEach((e,o)=>{null!=e&&(7!=o?6==o?(t[o].value=e.slice(0,10),t[o+1].value=e.slice(11,16)):t[o].value=e:t[o+1].value=e)})}$exportBtn=document.querySelector(".btn--exportData"),$dataExport=document.querySelector(".dataExport"),$newOpBtns=document.querySelectorAll(".btn--newContainer"),$opDataBtns=document.querySelectorAll(".btn--opData"),e.addEventListener("change",function(){"none"!=t.value?ImportData():alert("No format selected!\n\tA format is required to perform data import."),this.value=""}),$exportBtn.addEventListener("click",function(){"none"!=$dataExport.value?ExportData():alert("Action not completed!\n\tSelect some data to export.")}),$newOpBtns[0].onclick=(()=>{null!=localStorage.getItem("tempOp")&&SetOpInputsData(localStorage.getItem("tempOp")),document.querySelector(".newOpContainer").classList.toggle("display--n")}),$newOpBtns[1].onclick=(()=>{document.querySelector(".newOpContainer").classList.toggle("display--n")}),$opDataBtns[0].onclick=(()=>SaveOperationData()),$opDataBtns[1].onclick=(()=>ClearOpInputs()),document.querySelector(".btn--deleteData").onclick=(()=>{null!=localStorage.getItem("orderH")?confirm("DATA DELETION!\n\tAre you sure to want to proceed with the action?")&&(orderHistory=null,localStorage.removeItem("orderH"),localStorage.removeItem("tempOp"),localStorage.removeItem("oldestBalance"),chartsRef.forEach(e=>{null!=e&&e.destroy()}),document.querySelector(".opsTable__body").innerHTML="",alert("Action success!\n\tAll information has been completely removed")):alert("Action not completed!\n\tNo existing data to delete")})}{let e=document.querySelectorAll(".chart"),t={},o=document.querySelectorAll(".btn--chart"),r=document.querySelectorAll(".lyChartContainer");function GenerateChartsData(){let e,o,r,l,a=orderHistory.length,n=0,s=0,c=0,u=0,i=0,d=0,m=0,p=0,g=0,y=0,h=0,f=0,S=0,b=0,v=0,C=0,N=0,A=0,E=0,O=0,P=0;if(t.profitsEvolution=[[],[]],t.efectivity=[["TP %","SL %","BE %"],[]],t.profitAverage=[["TP $","SL $","BE $"],[]],t.directionalAverage=[["Long %","Short %"],[]],t.directionalProfits=[["Longs $","Shorts $"],[]],t.longsAverage=[["TP %","SL %","BE %"],[]],t.shortsAverage=[["TP %","SL %","BE %"],[]],t.longsAverageProfits=[["TP $","SL $","BE $"],[]],t.shortsAverageProfits=[["TP $","SL $"],[]],null!=localStorage.getItem("oldestBalance"))oldestBalance=Number(localStorage.getItem("oldestBalance"));else for(;;)if(oldestBalance=RoundNumber(parseFloat(prompt("Insert your current account balance:"))),isNaN(oldestBalance))alert("Action not completed! \n\tBalance must be a numeric value.");else if(oldestBalance>0){if(confirm(`Confirming the balance!\n\tIs this the correct value?: $${oldestBalance}`))break}else alert("Action not completed! \n\tBalance must be a value greater than zero.");orderHistory.forEach((R,T)=>{e=RoundNumber(R[2]*R[3]*R[5]+(R[2]*R[3]*45e-5*-1+R[7])),o=new Date(R[7]+"z"),o=`${o.getMonth()+1}.${o.getDate()}`,r=e,0!=T?r=RoundNumber(r+t.profitsEvolution[1][t.profitsEvolution[1].length-1]):null!=localStorage.getItem("oldestBalance")&&(r=RoundNumber(r+oldestBalance)),t.profitsEvolution[0].push(o),t.profitsEvolution[1].push(r),l=R[2]*R[3]/100,e>l?n++:e<0?s++:c++,T+1==a&&(t.efectivity[1].push(RoundNumber(100*n/a)),t.efectivity[1].push(RoundNumber(100*s/a)),t.efectivity[1].push(RoundNumber(100*c/a))),e>l?u+=e:e<0?i+=e:d+=e,T+1==a&&(t.profitAverage[1].push(RoundNumber(u/n)),t.profitAverage[1].push(RoundNumber(i/s)),t.profitAverage[1].push(RoundNumber(d/c))),R[4]?(m++,g+=e):(p++,y+=e),T+1==a&&(t.directionalAverage[1].push(RoundNumber(m/a*100)),t.directionalAverage[1].push(RoundNumber(p/a*100)),t.directionalProfits[1].push(RoundNumber(g/m)),t.directionalProfits[1].push(RoundNumber(y/p))),R[4]?e>l?(h++,b+=e):e<0?(f++,v+=e):(S++,C+=e):e>l?(N++,O+=e):e<0?(A++,P+=e):E++,T+1==a&&(t.longsAverage[1].push(RoundNumber(h/m*100)),t.longsAverage[1].push(RoundNumber(f/m*100)),t.longsAverage[1].push(RoundNumber(S/m*100)),t.shortsAverage[1].push(RoundNumber(N/p*100)),t.shortsAverage[1].push(RoundNumber(A/p*100)),t.shortsAverage[1].push(RoundNumber(E/p*100)),t.longsAverageProfits[1].push(RoundNumber(b/h)),t.longsAverageProfits[1].push(RoundNumber(v/f)),t.longsAverageProfits[1].push(RoundNumber(C/S)),t.shortsAverageProfits[1].push(RoundNumber(O/N)),t.shortsAverageProfits[1].push(RoundNumber(P/A)))}),null==localStorage.getItem("oldestBalance")&&(oldestBalance-=t.profitsEvolution[1][t.profitsEvolution[1].length-1],localStorage.setItem("oldestBalance",RoundNumber(oldestBalance)),t.profitsEvolution[1].forEach((e,o)=>{t.profitsEvolution[1][o]=RoundNumber(e+oldestBalance)})),GenerateTable(t.profitsEvolution[1]),t.profitsEvolution[0].unshift("x"),t.profitsEvolution[1].unshift(oldestBalance),GenerateCharts()}function GenerateCharts(){let o=[];if(0!=localStorage.getItem("theme")){let e=document.querySelector(":root");o=[getComputedStyle(e).getPropertyValue("--secondColor"),getComputedStyle(e).getPropertyValue("--color1"),getComputedStyle(e).getPropertyValue("--color2")]}else o=localStorage.getItem("themeColors").split(","),o.shift();e.forEach((e,r)=>{let l=e.dataset.name,a=t[l];null!=chartsRef[r]&&chartsRef[r].destroy(),"line"==e.dataset.type?chartsRef[r]=new Chart(e,{type:"line",data:{labels:a[0],datasets:[{data:a[1],pointBackgroundColor:o[0],borderColor:o[0],fill:{target:{value:oldestBalance},above:o[1],below:o[2]}}]},options:{scales:{x:{grid:{display:!1},ticks:{color:o[0]}},y:{grid:{color:o[0]},ticks:{color:o[0]}}},plugins:{legend:{display:!1}}}}):"circle"==e.dataset.type?chartsRef[r]=new Chart(e,{type:"doughnut",data:{labels:a[0],datasets:[{data:a[1],hoverOffset:4,borderWidth:2,borderColor:o[0],backgroundColor:[o[1],o[2],o[0]]}]},options:{layout:{padding:4},plugins:{legend:{display:!1}}}}):"semiCircle"==e.dataset.type?chartsRef[r]=new Chart(e,{type:"doughnut",data:{labels:a[0],datasets:[{data:a[1],circumference:180,rotation:-90,hoverOffset:4,borderWidth:2,borderColor:o[0],backgroundColor:[o[1],o[2],o[0]]}]},options:{layout:{padding:4},plugins:{legend:{display:!1}}}}):"bar"==e.dataset.type&&(chartsRef[r]=new Chart(e,{type:"bar",data:{labels:a[0],datasets:[{data:a[1],borderWidth:2,borderColor:o[0],backgroundColor:[o[1],o[2],o[0]]}]},options:{scales:{y:{grid:{color:o[0]},ticks:{color:o[0]}},x:{grid:{display:!1},ticks:{color:o[0]}}},plugins:{legend:{display:!1}}}}))})}o.forEach((e,t)=>{e.onclick=(()=>{let o=e.dataset.chartcontainer;document.querySelectorAll(".subLy")[0].classList.toggle("display--n"),document.querySelectorAll(".subLy")[1].classList.toggle("display--n"),t!=r.length&&r.forEach(e=>{e.dataset.chartcontainer==o?e.classList.remove("display--n"):e.classList.add("display--n")})})})}{function GenerateTable(e){let t=document.querySelector(".opsTable__body"),o=document.createElement("tbody"),r=document.createElement("tr"),l=oldestBalance;null==localStorage.getItem("oldestBalance")&&(l=(oldestBalance+(oldestBalance-e[0])).toFixed(2)),r.classList.add("tr"),r.innerHTML=`<td>--</td><td>--</td>\n      <td>--</td><td>--</td>\n      <td><b>${l}</b></td>`,o.appendChild(r),orderHistory.forEach((t,r)=>{let l=document.createElement("tr"),a=new Date(t[6]),n=[`${a.getFullYear()} `,RoundNumber(t[2]*t[3]*t[5]),RoundNumber(t[2]*t[3]*45e-5*-1+t[7]),null,e[r]];a.getMonth()+1>9?n[0]+=`${a.getMonth()+1}`:n[0]+=`0${a.getMonth()+1}`,a.getDate()>9?n[0]+=`.${a.getDate()}`:n[0]+=`.0${a.getDate()}`,n[3]=RoundNumber(n[1]+n[2]),n.forEach((e,t)=>{let o=document.createElement("td"),r=document.createTextNode(e);o.classList.add("td"),t!=n.length-1?o.appendChild(r):(b=document.createElement("b"),b.appendChild(r),o.appendChild(b)),l.appendChild(o)}),l.classList.add("tr"),o.appendChild(l)}),t.innerHTML="",t.innerHTML+=o.innerHTML}document.querySelector(".btn--opsTable").onclick=(()=>{document.querySelector(".tableContainer").classList.toggle("display--n")})}